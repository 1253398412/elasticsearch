[[span-queries]]
== Span queries

Span queries are low-level positional queries that provide precise control over the
order and proximity of matching terms. Span queries are typically used to
perform very specific searches on legal documents or patents.


[float]
[[span-query-mixes]]
=== Mixing span queries with other query types
Except for the `span_multi` query, you cannot use span queries with other query
types.


[float]
[[span-query-boosts]]
=== `boost` for nested span queries

For nested span queries, you can only set the `boost` parameter on the outermost
span query.

Compound span queries, like `span_near`, only use matching spans from inner
queries to find their own spans. <<query-filter-context, Relevance scores>> are
not calculated for inner span queries, which is why the `boost` parameter is not
allowed.


[float]
[[span-query-types]]
=== Span query types

<<query-dsl-span-containing-query,`span_containing` query>>::
Returns matching spans from a `big` span query that also match
a `little` span query.

<<query-dsl-span-field-masking-query,`field_masking_span` query>>::
Wraps another span query, letting you use queries like `span_near` or `span_or`
to search across different fields.

<<query-dsl-span-first-query,`span_first` query>>::
Wraps another span query whose returned documents must contain
matches within the first `N` positions of the field.

<<query-dsl-span-multi-term-query,`span_multi` query>>::
Wraps a <<query-dsl-fuzzy-query, `fuzzy`>>,
<<query-dsl-prefix-query, `prefix`>>, <<query-dsl-regexp-query, `regexp`>>, or
<<query-dsl-wildcard-query, `wildcard`>> query, which is run as a span query.

<<query-dsl-span-near-query,`span_near` query>>::
Wraps one or more span queries whose matches must be within the specified
distance of each other, and possibly in the same order.

<<query-dsl-span-not-query,`span_not` query>>::
Returns documents matching an `include` span query while removing overlapping
matches from an `exclude` span query.

<<query-dsl-span-or-query,`span_or` query>>::
Returns documents with spans that match one or more of wrapped span queries.

<<query-dsl-span-term-query,`span_term` query>>::
Matches spans that contain an exact term in a provided field.

<<query-dsl-span-within-query,`span_within` query>>::
Returns spans from a `little` span query that are enclosed in spans matching a
`big` span query.


include::span-containing-query.asciidoc[]

include::span-field-masking-query.asciidoc[]

include::span-first-query.asciidoc[]

include::span-multi-term-query.asciidoc[]

include::span-near-query.asciidoc[]

include::span-not-query.asciidoc[]

include::span-or-query.asciidoc[]

include::span-term-query.asciidoc[]

include::span-within-query.asciidoc[]