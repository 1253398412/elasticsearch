[[query-dsl-span-field-masking-query]]
=== Span field masking query
++++
<titleabbrev>Span field masking</titleabbrev>
++++

Wraps a <<span-queries,span query>>, letting you use queries like `span_near` or
`span_or` to search across different fields.

Queries like `span_near` or `span_or` require any nested queries search the same
field. With the `field_masking_span` query, you can use the `field` parameter to
meet that requirement but search a different field instead. This is particularly
useful for searching <<multi-fields-multiple-analyzers,multi-fields with
multiple analyzers>>.

[[span-mask-query-ex-request]]
==== Example request

[source,js]
----
GET /_search
{
  "query": {
    "span_near": {
      "clauses": [
        {
          "span_term": {
            "message": { "value": "quick brown" }
          }
        },
        {
          "field_masking_span": {
            "query": {
              "span_term": {
                "message.stems": { "value": "fox" }
              }
            },
            "field": "message"
          }
        }
      ],
      "slop": 5,
      "in_order": false
    }
  }
}
----
// CONSOLE

[[span-mask-top-level-params]]
==== Top-level parameters for `field_masking_span`
`query`::
+
--
(Required, query object) Contains a <<span-queries,span query>>.

While returned results are based on this query, the `field_masking_span` query
calculates <<query-filter-context, relevance scores>> using norms of the field
in the `field` parameter. This can result in unexpected relevance scoring.
--

`field`::
(Required, string) Field used to meet search field requirements.